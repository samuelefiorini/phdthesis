% !TEX root = ../main.tex

\chapter{Model for metabolic age prediction} \label{chap:frassoni}
% Frassoni sani + CCS

%Per rispondere alla richiesta di Samuele:
%- MDA (malondialdeide) è un marcatore della perossidazione lipidica, quindi dello stress ossidativo
%- Consumo d'ossigeno e ATP sintesi con P/M: valutazione del consumo di ossigeno e sintesi di ATP in presenza di piruvato e malato che stimolano la via mitocondriale composta da Complesso I, III e IV (valuta la funzionalità del mitocondrio)
%- Consumo d'ossigeno e ATP sintesi con succinato: valutazione del consumo di ossigeno e sintesi di ATP in presenza di succinato che stimola la via mitocondriale composta da Complesso II, III e IV (valuta la funzionalità del mitocondrio)
%- ATP: concentrazione intracellulare di ATP
%- AMP: concentrazione intracellulare di AMP
%- ATP/AMP: rapporto tra le due precedenti  misure che indica lo stato energetico cellulare ( più elevato più la cellula possiede energia)
%- LDH: attività della lattico deidrogenasi, ultimo enzima del pathway della glicolisi anaerobia (antagonista della fosforilazione ossidativa che noi valutiamo tramite i consumo d'ossigeno e la sintesi di ATP).

\begin{displayquote}
	\textit{In this chapter, we evaluate the changes of energy metabolism during the physiological aging. To this aim we will develop a ML model that predicts the age of an individual starting from the following molecular biomarkers: oxidative phosphorylation efficiency, the \ac{ATP}/\ac{AMP} ratio, the lactate dehydrogenase activity and the level of malondialdehyde.  For this purpose we employed mononuclear cells obtained from healthy population with age between $5$ and $106$ years.} \todo{rewrite the abstract}
\end{displayquote}

\section{Introduction: aging and metabolism} \label{sec:frassoni_intro}

In this chapter we present the first biomedical data science challenge of the thesis.
This consists in devising a ML model capable of predicting the age of an individual starting from a set of molecular biomarkers collected from $118$ volunteers\footnote{this was referred to as \textit{the aging problem} throughout Chapter~\ref{chap:state-of-the-art}}.
This chapter describes the extensive EDA and the thorough model selection procedure which lead to the development of the final model.
Before diving into the details of the experimental setup, let's see some preliminary biological notions of how aging influences our metabolism.

Aging is a multifactorial process characterized by a progressive decline of physiological functions~\cite{campisi2013aging} which leads to an increment of vulnerability and the relative risk of disease and death ~\cite{bratic2010mitochondrial}.

Aging represents the primary risk factor for several chronic pathologies, such as cancer, cardiovascular disorders, diabetes and neurodegeneration~\cite{lopez2013hallmarks}. Different molecular pathways seem involved in the aging process, including deregulated autophagy, mitochondrial dysfunction, telomere shortening, oxidative stress, systemic inflammation and metabolism dysfunction~\cite{lopez2013hallmarks, riera2016signaling}.

Recently, an involvement of epigenetic modifications has been proposed~\cite{thompson2017epigenetic}, developing an \textit{aging clock} based on the degree of DNA methylation, which increases with the age~\cite{horvath2013dna}. However, for several years, aging has been considered the result of damages accumulation due to an excessive production of reactive oxygen species.

The \textit{Mitochondrial Theory of Aging}~\cite{harman1972biologic, sastre2000mitochondrial} derives from the  concept that mitochondria are the main source of oxidative stress~\cite{cadenas2000mitochondrial, turrens2003mitochondrial, dai2014mitochondrial} and the fact that mitochondrial DNA displays a
great rate of mutation together with a less efficient repair machinery with respect to nuclear DNA~\cite{short2005decline}. After some mitochondrial DNA mutation threshold, irreversible oxidative damages propagate throughout the genome. This phenomenon leads to dysfunction of mitochondrial metabolism~\cite{genova2004mitochondrial} accelerating the oxidative stress production~\cite{wallace2010mitochondrial}.

As shown in~\cite{mckerrell2015leukemia}, mononuclear cells isolated from peripheral blood, are an excellent model to evaluate the metabolic status of an entire organism. In fact, the molecular alterations identified in peripheral blood cells of aged normal subjects are statistically correlated with degenerative diseases~\cite{jaiswal2014age}.


\section{Data collection} \label{sec:frassoni_data_collection}

The study presented in this chapter is performed on mononuclear cells isolated from peripheral blood obtained from a population of $118$ volunteers\footnote{all participants provided their written informed consent to participate in this study, which was approved by the Ethics Committee of the IRCCS Istituto G. Gaslini, Genoa, IT, \todo{(N°)}} with age between $8$ and $106$ years.
In order to preserve the collected blood samples, the vacutainer tubes were transferred into the laboratory and analyzed within $24$ hours from collection.
All chemicals were purchased from Sigma Aldrich (St. Louis, MO, USA) and Ultrapure water (Milli-Q; Millipore, Billerica, MA, USA) was used throughout. All other reagents were of analytical grade.
Data collection and further analysis were managed by a team of specialized biologists at the IRCCS Istituto G. Gaslini, Genoa, IT. The following quantities were measured, on each blood sample.

\begin{itemize}
	\item[] \textbf{ATP} This complex molecule is the main responsible for storing and exchanging energy in cells and it is often referred to as the \textit{energy currency} of the cell. From a chemical point of view, ATP is made of an adenine base attached to a ribose sugar, which, in turn, is attached to three phosphate groups.
	ATP is heavily involved in the cellular aerobic respiration pathway. High levels of ATP correspond to high energetic state.
	ATP intracellular concentration, measured in $\text{mM}/\text{ml}$, is an important molecular biomarker to evaluate the energetic state of a cell.
	
	\item[] \textbf{AMP} This molecule is one of the main derivatives of ATP. In fact, AMP ca be obtained when two phosphate groups are removed from ATP, releasing energy that can be transferred to other molecules to trigger further cell reactions.
	So, when a cell is in good health, \ie high energetic level, AMP is low and ATP is high.
	AMP intracellular concentration is measured in $\text{mM}/\text{ml}$ and it is considered as an important molecular biomarker for the cellular energetic state. ATP and AMP quantification was based on the enzyme coupling method presented in~\cite{ravera2013tricarboxylic}.
%	as a side product of the ATP synthesis process or 
	
	\item[] \textbf{ATP/AMP ratio} Measuring ATP and AMP cellular concentration may not be enough to predict the age of an individual by assessing the energetic state of the peripheral blood cells. A more representative and interesting quantity can be their ratio, so ATP/AMP ratio was calculated and added to the feature set.
	
	\item[] \textbf{Oxygen consumption} Aerobic cellular respiration requires oxygen to produce ATP. Therefore, the cellular oximetric level is an important molecular biomarker for the metabolic assessment. Oxygen consumption was measured with an amperometric electrode in a closed chamber, magnetically stirred, at 37°C. The oxygen consumption measure, expressed in $\text{nmol~O}_2/(\text{min}\cdot\text{mg})$, is repeated in two versions, adding two different substrates, \ie:
	\begin{enumerate*}[label=(\roman*)]
		\item a combination of $5~\text{mM}$ pyruvate with $2.5~\text{mM}$ malate or
		\item only $20~\text{mM}$ succinate.
	\end{enumerate*}
	In the first oximetric measure, which from now on will be referred to as \copyrmal, the substrate stimulates the pathway composed by Complexes I, III and IV. On the other hand, in the second oximetric measure, which we call \cosucc, the substrate activates the pathway composed by Complexes II, III and IV, as described in~\cite{cappelli2017defects}.
	
	\item[] \textbf{ATP synthesis} We already covered the importance of ATP to evaluate the metabolic state of cells. So, we also measured ATP synthesis, expressed in $\text{nmol~ATP}/(\text{min}\cdot\text{mg})$,  by the highly sensitive luciferin/luciferase method. The same two substrates used for the oximetric evaluation were adopted. In the remainder of the chapter we refer to such measures as \atppyrmal and \atpsucc, accordingly.
	
	\item[] \textbf{P/O ratio} In order to assess the efficiency of oxidative phosphorylation, we also evaluated the ratio between ATP synthesis and oxygen consumption under both the substrates. We call the two obtained features as \popyrmal and \posucc, respectively.
	
	\item[] \textbf{Glycolytic flux} In order to assay the glycolytic flux, we measured the activity of the Lactate Dehydrogenase (\ac{LDH}), expressed in $\text{U}/\text{mg}$. This enzyme is important to evaluate the other metabolic pathway not mentioned so far, \ie the anaerobic respiration.
	
	\item[] \textbf{Lipid peroxidation} The uncoupled oxidative phosphorylation metabolism is often associated with an increment in the oxidative stress production~\cite{dai2014mitochondrial}, which induces damages on proteins, nucleic acid and membrane. Therefore, we evaluated the level of malondialdehyde (\ac{MDA}) as a marker of lipid peroxidation. The measure of \mda follows the protocol in~\cite{ravera2015oxidative}.
\end{itemize}

Each sample of this dataset is then described by the $12$-dimensional feature set summarized in Table~\ref{tab:aging_features}.

\begin{table}[]
	\centering
	\caption{The $12$-dimensional feature set.}
	\label{tab:aging_features}
	\begin{tabular}{@{}ll@{}}
		\toprule
		\textbf{Measure}                                    & \textbf{Feature name}\\ \midrule
		Gender of the individual                      & gender          \\
		ATP intracellular concentration            & \atp         \\
		AMP intracellular concentration            & \amp         \\
		ATP/AMP ratio                              & \atpamp      \\
		Oxygen consumption under Pyruvate + Malate & \copyrmal    \\
		Oxygen consumption under Succinate         & \cosucc      \\
		ATP synthesis under Pyruvate + Malate      & \atppyrmal   \\
		ATP synthesis under Succinate              & \atpsucc     \\
		P/O ratio under Pyruvate + Malate          & \popyrmal    \\
		P/O ratio under Succinate                  & \posucc      \\
		Glycolytic flux                            & \ldh         \\
		Lipid peroxidation                         & \mda         \\ \bottomrule
	\end{tabular}
\end{table}


\section{Exploratory data analysis} \label{sec:frassoni_EDA}
% BOXPLOT - PCA - HEATMAP etc
In this section we investigate on the relationship between the collected molecular biomarkers and the age of $118$ healthy individuals which volunteered to participate to this study.
Unfortunately, $7$ subjects presented missing values (in the features \ldh and sex). These subjects were excluded from EDA.


The data collection process entirely ran on voluntary basis. So, it is interesting to investigate on the resulting age distribution. As we can see from the histogram in Figure~\ref{fig:frassoni_agehist}, the decades of age are not equally represented. Ideally, we would have collected samples uniformly distributed with respect to their age, but this was unfortunately not possible.
%Therefore, we shall provide appropriate countermeasures to avoid bias in the following supervised regression step \todo{false so far}.

\begin{figure}[]
	\centering
	\includegraphics[width=0.8\textwidth]{part2/aging_agehist.png}
	\caption{Age distribution of the $118$ individuals involved in the study.} \label{fig:frassoni_agehist}
\end{figure}

Next, we aim at investigating on how the distribution of the molecular biomarkers is influenced by the age of individuals. To this aim we group the measures per decade and we represent their distribution with boxplots, see Figure~\ref{fig:frassoni_boxplot}.
As we can see, most of the biomarkers are clearly influenced by the age.
Let's start the visual inspection focusing on the variables related to the mitochondrial aerobic metabolism (from Figure~\ref{fig:frassoni_boxplot_copyrmal} to \ref{fig:frassoni_boxplot_atpamp}).
In particular, focusing our attention on the \atpamp ratio (Figure~\ref{fig:frassoni_boxplot_atpamp}), which is known to be an energy status monitor of the cells, we can see that the values decrease progressively with the decades, with a drastic drop between $40$ and $50$ years. Moreover, from an observation of \atp and \amp intracellular concentration (Figure~\ref{fig:frassoni_boxplot_atp} and Figure~\ref{fig:frassoni_boxplot_amp}, respectively) we can sense how the decrease of the \atpamp ratio is mainly due to the growth of \amp in the aging process.
Similar considerations can be made for the efficiency of oxidative phosphorylation, evaluated by \popyrmal and \posucc. In particular, \popyrmal oscillates around its reference level of $2.5~\text{nmol~O}_2/(\text{min}\cdot\text{mg})$~\cite{hinkle2005p} in subjects having from $0$ to $30$ years starting to decrease afterwards. Moreover, \popyrmal, similarly to \atpamp, is fairly stable at its lowest level for elderly (age $\geq 70$).
Let's now focus on the activity of LDH (Figure~\ref{fig:frassoni_boxplot_ldh}). As we can see, this metabolic biomarker almost monotonically increases with the aging process.
This is mainly due to the fact that LDH is involved in the glycolysis metabolism, which is a metabolic pathway chosen by the cell to compensate its altered aerobic metabolism.
Finally, let's focus on the distributions of the \mda (Figure~\ref{fig:frassoni_boxplot_mda}). As expected, \mda has an opposite trend with respect to \atpamp and \popyrmal. In fact, it increases from $21$ to $80$ years. This can be due to the increased oxidative stress production induced by uncoupled oxidative phosphorylation~\cite{dai2014mitochondrial}.
\mda is more stable for elderly, mainly because of their physiological metabolic slowdown.

\begin{figure}[]
	\centering
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_CO-PyrMal.png}
		\label{fig:frassoni_boxplot_copyrmal}%
	}%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_CO-Succinate.png}
		\label{fig:frassoni_boxplot_cosucc}%
	}%
%	\hfill%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_ATP-PyrMal.png}
		\label{fig:frassoni_boxplot_atppyrmal}%
	}%
	\hfill% %%%% ROW 2
	\subfloat[]{%
	   \includegraphics[width=0.33\textwidth]{part2/aging_boxplot_ATP-Succinate.png}
       \label{fig:frassoni_boxplot_atpsucc}%
	}%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_PO-PyrMal.png}
		\label{fig:frassoni_boxplot_popyrmal}%
	}%
	%	\hfill%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_PO-Succinate.png}
		\label{fig:frassoni_boxplot_posucc}%
	}%
	\hfill%%%% ROW 3
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_ATP.png}
		\label{fig:frassoni_boxplot_atp}%
	}%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_AMP.png}
		\label{fig:frassoni_boxplot_amp}%
	}%
	%	\hfill%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_ATPAMP.png}
		\label{fig:frassoni_boxplot_atpamp}%
	}%
	\hfill%%%% ROW 4
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_MDA.png}
		\label{fig:frassoni_boxplot_mda}%
	}%
	%	\hfill%
	\subfloat[]{%
		\includegraphics[width=0.33\textwidth]{part2/aging_boxplot_LDH.png}
		\label{fig:frassoni_boxplot_ldh}%
	}%
	\caption{Distribution of the collected molecular biomarker values grouped per decade.} \label{fig:frassoni_boxplot}
\end{figure}

So far, we have investigated on the relationship between the collected measures and the age of the individuals. Let's now focus on the relationship between the variables themselves. In order to investigate on possible collinearities in the data, we evaluated the Pearson correlation coefficient
\begin{equation}
	\rho(a, b) = \frac{\sum_{i=1}^n (a_i - \bar a)(b_i - \bar b)}{\sqrt{\sum_{i=1}^n(a_i-\bar a)^2 \sum_{i=1}^n(b_i-\bar b)^2}}
\end{equation}
(where $\bar c = \frac{1}{n}\sum_{i=1} c_i$ is the empirical mean of the variable $c$) for each pair of variables. This results in a symmetric $11 \times 11$ correlation matrix.
%In order to evaluate a specific age fingerprint,
We split the data in $5$ groups, one for each two-decades, and we represent the collinearity in each group with a symmetric heatmap in which dark red cells are associated with strong positive correlation, white cells represent no correlation and dark blue cells correspond to strong negative correlation, see Figure~\ref{fig:heatmaps}.
Thanks to this visualization, we can see that \atpamp and \popyrmal have positive correlation until the $6^{\text{th}}$ decade, while showing a negative correlation for elderly.
This suggests that up to approximately $60$ years, most of the cellular energy is produced by the mitochondria, while in older subjects this contribution decreases. The same observation can be made for \atpamp and \posucc, although in this case it is less evident. On the other hand, the correlation between \atpamp and \mda or \ldh activity is negative in young subjects, while flipping it sign after approximately $60$ years.
This is in line with the cellular need to increase the anaerobic metabolism that compensates the inefficiency of aerobic metabolism and the increment of oxidative stress which usually occurs for elderly.

\begin{figure}[]
	\centering
	\subfloat[]{%
		\includegraphics[width=0.5\textwidth]{part2/aging_heatmap_years range_0.png}
		\label{fig:heatmaps1}%
	}%
	\subfloat[]{%
		\includegraphics[width=0.5\textwidth]{part2/aging_heatmap_years range_1.png}
		\label{fig:heatmaps2}%
	}%
		\hfill%
	\subfloat[]{%
		\includegraphics[width=0.5\textwidth]{part2/aging_heatmap_years range_2.png}
		\label{fig:heatmaps3}%
	}%
%	\hfill% %%%% 
	\subfloat[]{%
		\includegraphics[width=0.5\textwidth]{part2/aging_heatmap_years range_3.png}
		\label{fig:heatmaps4}%
	}%
   \hfill
	\subfloat[]{%
		\includegraphics[width=0.5\textwidth]{part2/aging_heatmap_years range_4.png}
		\label{fig:heatmaps5}%
	}%
	\caption{The $11 \times 11$ symmetric heatmaps representing the Pearson correlation coefficient of the collected variables in the $5$ age groups: $[1-20]$ (a), $[21-40]$ (b), $[41-60]$ (c), $[61-80]$ (d), $>81$ (e).} \label{fig:heatmaps}
\end{figure}


Let's now try to visualize the collected data in a scatter plot. In order to do that, we shall first reduce the dimensionality of the problem, as described in Section~\ref{sec:dimred}.
Most of the variables showed strong linear correlation between themselves and some of them also with respect to the age. We then reduce the dimensionality of the problem following a two step pipeline:
\begin{enumerate*}[label=(\roman*)]
	\item data standardization followed by
	\item via linear PCA.
\end{enumerate*}
Our hope is to be able to recognize some, approximately linear, temporal structure. The resulting scatter plot is presented in Figure~\ref{fig:frassoni_PCA}.
Each point in the scatter plot represents a subject color coded according to the age.
Let's read the image from left to right.
As we can see, it looks like the subjects are partially grouped according to their age. In the top left corner of Figure~\ref{fig:frassoni_PCA} subjects with approximately $20$ years (or less) are clustered together. At the center bottom of the plot we can recognize individuals around their thirties. Then, following an approximately linear law from center bottom to top right we can see that the age increases until reaching the elderly, color coded in dark red.
The insightful data visualization in Figure~\ref{fig:frassoni_PCA}, gives us hopes to be able to devise a supervised strategy to predict the age of a given individual starting from these molecular biomarkers.

\begin{figure}[]
	\centering
	\includegraphics[width=0.8\textwidth]{part2/aging_PCA.png}
	\caption{Scatter plot obtained after projecting the data in a $3D$ space via linear PCA. The color-coding represents the age of the individuals.} \label{fig:frassoni_PCA}
\end{figure}


\section{Metabolic age prediction} \label{sec:frassoni_regression}
% pipeline + assessment + model challenge
This section presents the development of the regression model for the age prediction task presented in this chapter.

To this aim, we imputed the small fraction of missing values following the $k$-nearest neighbors (with $k=3$) proposed in~\cite{troyanskaya2001missing}. So, the development of the predictive model can take advantage of the total number of individuals ($n=118$).

The fist question we pose is whether the collected dataset is large \textit{enough} for our purpose, or we should keep enrolling new volunteers. Providing a definitive answer for this question is, in general, unfeasible. Nevertheless, we can investigate in this direction by evaluating the so-called \textit{learning curves}. Such graphical representation is obtained by iteratively fitting a given regression model on increasingly large chunks of the entire dataset.
Horizontal axis corresponds to the number of training samples, while vertical axis represents mean values of some cross-validated regression metric (such as MAE).
The shape of the obtained learning curve tells a lot about the prediction problem at hand. For instance, if the cross-validation error keeps decreasing we may sense that there may be (much) \textit{more} to learn about the input/output relationship. In this case, the regression performance would benefit from a larger dataset. Conversely, if the cross-validation error initially decreases eventually reaching a plateau it may be that the number of samples is large enough and collecting more data would only marginally improve the prediction performance. This may happen mainly because:
\begin{enumerate*}[label=(\roman*)]
	\item the available feature set only partially explains the input/output relationship and more/better variables should be observed to improve the regression performance, or
	\item the selected model is incapable of capturing some of the input/output relationship already hidden in the data.
\end{enumerate*}
Learning curves plot gives also information on the amount of bias and variance affecting a given predictive model.
Four our purpose, we rely on the use of standard Ridge regression model (see Section~\ref{sec:ridge_regression}) and 100-splits Monte Carlo cross-validated MAE to evaluate each point of our learning curves (see Section~\ref{sec:frassoni_results}).

In EDA we realized that most of the input variables show a quasi-linear relationship with the age. Moreover, we also realized that many molecular biomarkers present a strong pairwise linear correlation. Therefore it seems sensible to investigate whether a polynomial feature expansion could be beneficial for the age prediction.
To this aim, we devised the following experimental design.

A cross-validated estimate of four regression scores: $\text{R}^2$, MAE, MSE and EV (defined in Section~\ref{sec:performance_metrics}) is evaluated.
In order to achieve a reliable estimate of their empirical distribution, we opted for a Monte Carlo cross-validation strategy.
%\todo{should have been stratified -> correggere}.
This strategy consists in iteratively extracting $n_{\text{train}} = 0.75 \cdot n$ random samples multiple times\footnote{the fraction of data to use for training is chosen accordingly to the learning curve in Figure~\ref{fig:frassoni_learning_curves}}. On each obtained training set a supervised learning model is fitted. In our experiments, we ran a total of $500$ Monte Carlo resampling.
%\todo{As not each age decade is equally represented, see Figure~\ref{fig:frassoni_agehist}, we opted for a cross-validation strategy that is stratified with respect to the decades. So, in each random extraction, the same proportion of samples}
Once the model is fitted, the five regression scores are then evaluated on the remaining $n_{\text{test}} = n - n_{\text{train}}$ samples.
The adopted supervised model consists in a pipeline having two steps:
\begin{enumerate*}[label=(\roman*)]
	\item data standardization and
	\item regression model fitting.
\end{enumerate*}
The first step simply consists in subtracting the mean from each feature and dividing them by their standard deviation. Nesting this preprocessing step inside the Monte Carlo cross-validation scheme improves the empirical estimate of the regression scores. In fact, for each cross-validation iteration, the mean and the standard deviation are estimated from the training set only. This allows to have, each time, a genuine score, estimated only on data points that were never seen before by the current supervised pipeline.
Moreover, for the second step of the pipeline we adopted the following regression models:
\begin{enumerate*}[label=(\alph*)]
	\item Ridge,
	\item Lasso,
	\item Elastic-Net,
	\item Linear SVM,
	\item RBF Kernel SVM,
	\item RBF Kernel Ridge,
	\item Random Forests,
	\item Gradient Boosting and
	\item Multilayer Perceptron.
\end{enumerate*}
The free parameter of each model, see Section~\ref{subsec:supervised_learning}, are optimized via grid search $5$-fold cross-validation scheme.

This procedure is evaluated two times: with and without a preliminary polynomial feature expansion of degree $2$. We expect linear models to benefit more from the polynomial expansion than the nonlinear ones.
Then, for each model and for each metric, we evaluated the p-value obtained from the one-tailed two-sample Kolmogorov–Smirnov test~\cite{everitt2002cambridge}. This let us understand in which cases the scores obtained after a polynomial expansion are significantly better than their counterpart, obtained only with  linear features.

The final goal of this section is to find the best age prediction model. Therefore, it is important to understand which are the most predictive variables.
So, as a side result of the previous analysis, we ranked the features according to their selection frequency. The most important features are more likely to be selected more often. This strategy is known in literature as  \textit{selection stability framework}~\cite{meinshausen2010stability, barbieri16palladio} and, for our purposes, it let us get a preview of which features will appear in the final model.

Finally, the proposed age predicting model is achieved by fitting the best regression strategy on a training set obtained by randomly extracting $75\%$ of the whole dataset. This model is eventually tested, by the usual metrics, on the remaining $25\%$. We expect to achieve regression metrics in line with the previous experiments.

\section{Results} \label{sec:frassoni_results}
% tabella dei risultati

\input{part2/summary}
\input{part2/stats}

\begin{figure}[]
	\centering
	\includegraphics[width=0.8\textwidth]{part2/aging_learning_curve_linfeat}
	\caption{Learning curves} \label{fig:frassoni_learning_curves}
\end{figure}


\begin{figure}[]
	\centering
	\includegraphics[width=0.8\textwidth]{part2/aging_topfeatures.png}
	\caption{The top features ... lasso ... stability selection.} \label{fig:frassoni_topfeat}
\end{figure}

%test MAE 5.904
%test MSE 78.075
%test R2 0.873
%test EV 0.879

\begin{figure}[]
	\centering
	\includegraphics[width=0.8\textwidth]{part2/aging_lassopolyfeat.png}
	\caption{The top model ... lasso ....} \label{fig:frassoni_topmodel}
\end{figure}



\section{Conclusions and future works} \label{sec:frassoni_conclusions}
% CCS

future: collect more data in order to have a uniformly distributed dataset

%%